# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `fx` ‚Äî –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç –¶–ë –†–§

## üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å —É—á–µ–±–Ω–æ–µ CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Go (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Cobra), –∫–æ—Ç–æ—Ä–æ–µ:
- –ø–æ–ª—É—á–∞–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫—É—Ä—Å –≤–∞–ª—é—Ç —Å —Å–∞–π—Ç–∞ –¶–ë –†–§,
- –≤—ã–≤–æ–¥–∏—Ç –∫—É—Ä—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å,
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –∫–æ–¥—É –≤–∞–ª—é—Ç—ã (`USD`, `EUR`, `GBP` –∏ —Ç.–¥.) –∏ –¥–∞—Ç–µ (`YYYY-MM-DD`),
- —É–º–µ–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤—Å–µ—Ö –≤–∞–ª—é—Ç –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É.
- —É–º–µ–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å –∫—É—Ä—Å –≤–∞–ª—é—Ç—ã –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–∞–ª—é—Ç –≤ `json`

---

## üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### 1. –ö—É—Ä—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–ª—é—Ç—ã –∑–∞ –¥–∞—Ç—É
```bash
fx rate --code USD --date 2025-11-01
# => 1 USD = 97.12 RUB (–Ω–∞ 2025-11-01)
```
–ï—Å–ª–∏ `--date` –Ω–µ —É–∫–∞–∑–∞–Ω–∞ ‚Äî –±–µ—Ä—ë—Ç—Å—è —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞.  
–ï—Å–ª–∏ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –∫—É—Ä—Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—Ö–æ–¥–Ω–æ–π), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–ª–∏–∂–∞–π—à–∞—è –ø—Ä–µ–¥—ã–¥—É—â–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞.

---

### 2. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–∞–ª—é—Ç –∑–∞ –¥–∞—Ç—É
```bash
fx list --date 2025-11-01
# => –¢–∞–±–ª–∏—Ü–∞: CharCode | NumCode | Name | Nominal | Value (RUB)
```

---

## üåê –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π XML –¶–ë –†–§:**
```
https://www.cbr.ru/scripts/XML_daily.asp?date_req=DD/MM/YYYY
```

- –§–æ—Ä–º–∞—Ç XML: `ValCurs -> Valute[]`
- –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
  ```xml
  <ValCurs Date="09.11.2025" name="Foreign Currency Market">
    <Valute ID="R01235">
      <NumCode>840</NumCode>
      <CharCode>USD</CharCode>
      <Nominal>1</Nominal>
      <Name>–î–æ–ª–ª–∞—Ä –°–®–ê</Name>
      <Value>97,12</Value>
    </Valute>
  </ValCurs>
  ```

---

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –ü–æ–¥–∫–æ–º–∞–Ω–¥–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏ |
|-------------|-------------|----------------|
| `fx rate` | –ü–æ–∫–∞–∑–∞—Ç—å –∫—É—Ä—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–ª—é—Ç—ã | `--code, -c` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π), `--date, -d` |
| `fx list` | –ü–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤—Å–µ—Ö –≤–∞–ª—é—Ç | `--date, -d` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

- –í–∞–ª–∏–¥–∞—Ü–∏—è `--code` –ø–æ `CharCode`.
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã: –≤—Ö–æ–¥–Ω–æ–π `YYYY-MM-DD`, –∑–∞–ø—Ä–æ—Å –∫ –¶–ë –≤ `DD/MM/YYYY`.
- –£—á–∏—Ç—ã–≤–∞—Ç—å `Nominal` ‚Äî –∫—É—Ä—Å –≤—Å–µ–≥–¥–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è **–∫ –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü–µ –≤–∞–ª—é—Ç—ã**.
- –í—ã–≤–æ–¥:
    - `rate`: —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ json `--json`.
    - `list`: —Ç–∞–±–ª–∏—Ü–∞ bkb json `--json`.

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
fx/
  cmd/
    main.go
  internal/
    commands/
        list.go
        rate.go 
    cbr/
      client.go        // HTTP-–∑–∞–ø—Ä–æ—Å, retry, –ø–∞—Ä—Å–∏–Ω–≥ XML
      model.go         // —Å—Ç—Ä—É–∫—Ç—É—Ä—ã XML
      parser.go        // –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è Nominal/Value
    format/
      table.go         // —Ç–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥
      json.go          // JSON –≤—ã–≤–æ–¥
    timeutil/
      date.go          // –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–∞—Ç
  testdata/
    cbr_daily_sample.xml
  go.mod
  README.md
  Makefile
```

---

## üß™ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞—á–µ—Å—Ç–≤—É –∏ —Ç–µ—Å—Ç–∞–º

- Go ‚â• 1.22
- –õ–∏–Ω—Ç–µ—Ä: `golangci-lint`
- –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:
    - –ø–∞—Ä—Å–∏–Ω–≥ XML,
    - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ `Nominal`,
    - –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç,
    - –∫–æ–º–∞–Ω–¥—ã `rate` –∏ `list` —Å –º–æ–∫–∞–º–∏.
- CI (GitHub Actions): `build`, `lint`, `test`.
- –ö–æ–¥ –≤—ã—Ö–æ–¥–∞: `0` ‚Äî —É—Å–ø–µ—Ö, `1` ‚Äî –æ—à–∏–±–∫–∞ (–≤–∞–ª–∏–¥–∞—Ü–∏—è, —Å–µ—Ç—å, –ø–∞—Ä—Å–∏–Ω–≥).

---

## üß© –ü—Ä–∏—ë–º–æ—á–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (MVP)

- `fx rate -c USD` ‚Äî –≤—ã–≤–æ–¥–∏—Ç –∫—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞ –∑–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –¥–∞—Ç—É.
- `fx rate -c EUR -d 2024-01-15` ‚Äî –≤—ã–≤–æ–¥–∏—Ç –∫—É—Ä—Å –µ–≤—Ä–æ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É.
- `fx list -d 2024-01-15` ‚Äî –≤—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É –≤—Å–µ—Ö –≤–∞–ª—é—Ç.
- –ü—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º –∫–æ–¥–µ –≤–∞–ª—é—Ç—ã –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:
  ```
  –í–∞–ª—é—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ fx list –¥–ª—è —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–¥–æ–≤.
  ```
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫—É—Ä—Å–∞ –Ω–∞ –¥–∞—Ç—É ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞.
- –í—Å–µ —Ç–µ—Å—Ç—ã –∏ –ª–∏–Ω—Ç–µ—Ä –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ.

---

## üìã –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

### 1. –ö—É—Ä—Å –æ–¥–Ω–æ–π –≤–∞–ª—é—Ç—ã
```bash
$ fx rate --code USD
1 USD = 97.12 RUB (–Ω–∞ 2025-11-07)
```

### 2. –í—Å–µ –≤–∞–ª—é—Ç—ã
```bash
$ fx list -d 2024-01-15
CharCode  NumCode  Name                  Value(RUB)  Date
USD       840      –î–æ–ª–ª–∞—Ä –°–®–ê            97.1200     2024-01-15
EUR       978      –ï–≤—Ä–æ                  100.5500    2024-01-15
GBP       826      –§—É–Ω—Ç —Å—Ç–µ—Ä–ª–∏–Ω–≥–æ–≤       118.4300    2024-01-15
...
```

---

## üöÄ –ü–ª–∞–Ω—ã –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ

| –í–µ—Ä—Å–∏—è | –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ |
|--------|-------------------|
| 0.1.0  | –ë–∞–∑–æ–≤—ã–π CLI —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ `rate` –∏ `list` |
| 0.2.0  | JSON-–≤—ã–≤–æ–¥ (`--json`), –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–ª—É—á—à–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç |

---

## üß† –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- –î–ª—è –∑–∞–ø—Ä–æ—Å–∞ –¶–ë –†–§:  
  `https://www.cbr.ru/scripts/XML_daily.asp?date_req=DD/MM/YYYY`
- XML-–ø–æ–ª—è —Å –∑–∞–ø—è—Ç–æ–π (`97,12`) –Ω—É–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ `ParseFloat`.
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: `–∫—É—Ä—Å = Value / Nominal`
- –ï—Å–ª–∏ `--date` –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `time.Now()`
- –î–ª—è –º–æ–∫–æ–≤ –∏ —Ç–µ—Å—Ç–æ–≤ —Å–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `RatesProvider`.

---

## ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (Smoke test)

```bash
go run main.go rate --code USD
# –î–æ–ª–∂–µ–Ω –Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å –∫—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞ –∑–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –¥–∞—Ç—É

go run main.go list
# –î–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü—É –≤–∞–ª—é—Ç (USD, EUR, GBP –∏ –¥—Ä.)
```
